<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head('User Profile')"></head>
<body>

<!-- Navbar -->
<div th:replace="fragments/navbar :: navbar"></div>

<h1>User Profile</h1>

<!-- Guest view -->
<div th:if="${isAuthenticated != true}">
    <div class="alert alert-info">
        You are viewing as guest.
        <a href="/login">Login</a> or <a href="/signup">Sign up</a>.
    </div>
</div>

<!-- Authenticated view -->
<div th:if="${isAuthenticated == true}">

    <!-- User info -->
    <div>
        <strong>Username:</strong> <span th:text="${account.username}">username</span>
    </div>
    <hr/>

    <!-- Linked Memberships -->
    <h2>Linked Memberships</h2>
    <div th:if="${#lists.isEmpty(memberships)}">
        No memberships linked.
    </div>
    <div th:each="m : ${memberships}">
        <span th:text="${m.type}">Type</span> -
        <span th:text="${m.organizationName}">Org</span>
        <form th:action="@{/profile/memberships/remove}" method="post" style="display:inline;">
            <input type="hidden" name="membershipId" th:value="${m.id}" />
            <button class="btn btn-sm btn-outline-danger" type="submit">Remove</button>
        </form>
    </div>
    <hr/>

    <!-- Add Membership -->
    <h2>Add Membership</h2>
    <form th:action="@{/profile/memberships/add}" method="post" style="display:flex; gap:6px; margin-bottom:1rem;">
        <select name="membershipId" class="form-select">
            <option th:each="m : ${allMemberships}" th:value="${m.id}" th:text="${m.type} + ' - ' + ${m.organizationName}"></option>
        </select>
        <button class="btn btn-primary" type="submit">Add</button>
    </form>

</div>

<!-- Footer -->
<div th:replace="fragments/footer :: footer"></div>

</body>
</html>
